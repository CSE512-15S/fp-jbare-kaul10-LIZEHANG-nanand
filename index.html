<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  <style>

    path {
      
      stroke: #ccc;
      stroke-width: 1px;
    }

    path:hover {
      fill: red;
    }

  </style>
</head>
<body>
  <script src="http://d3js.org/d3.v3.min.js"></script>
  <script src="http://d3js.org/topojson.v1.min.js"></script>
  <script type="text/javascript" src="index.js"></script>
  <script type="text/javascript" src="helperFunctions.js"></script>
  <script>

    var width = 1500,
        height = 900;

    var svg = d3.select("body").append("svg")
        .attr("width", width)
        .attr("height", height);

    var dataset = "zips_wash_topo.json";

    d3.json(dataset, function(error, wa) {
      var wash = topojson.feature(wa, wa.objects.wash);

      var projection = d3.geo.albers()
          .rotate([119, 0])
          .center([-3, 48])
          .parallels([35, 50])
          .scale(10000)
          .translate([width / 4, height / 4])
          .precision(.1);

      var path = d3.geo.path()
        .projection(projection);

      //Declaring the tool tip variable 
    	var tip = d3.tip()
        .attr('class', 'd3-tip')
        .offset([-10, 0])
        .html(function(d) {
          return "<strong style='color:red'>Name:</strong> <span style='color:red'>" + d.properties.name +
          "</span><br><strong style='color:red'>Zip Code:</strong> <span style='color:red'>" + d.properties.zip + "</span>";
           
      })

      //Calling the tool tip within the svg
    	svg.call(tip);

      svg.selectAll("path")
          .data(wash.features)
          .enter().append("path")          
          .attr("d", path)
          .style("fill", function(d) {
            if (getUtilities(d.properties.zip) !== 0) {
              return multiplyHexColor("111111", getUtilityStats((getUtilities(d.properties.zip))[0])[1]);
            } else {
              return "#ffffff";
            }
          })
          .on('mouseover', tip.show)
          .on('mouseout', tip.hide);
    });

  </script>

</body>
